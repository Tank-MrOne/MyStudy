(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7d8461d8"],{"28a5":function(t,e,a){"use strict";var l=a("aae3"),n=a("cb7c"),s=a("ebd6"),i=a("0390"),r=a("9def"),u=a("5f1b"),o=a("520a"),c=a("79e5"),f=Math.min,d=[].push,p="split",m="length",h="lastIndex",g=4294967295,I=!c((function(){RegExp(g,"y")}));a("214f")("split",2,(function(t,e,a,c){var v;return v="c"=="abbc"[p](/(b)*/)[1]||4!="test"[p](/(?:)/,-1)[m]||2!="ab"[p](/(?:ab)*/)[m]||4!="."[p](/(.?)(.?)/)[m]||"."[p](/()()/)[m]>1||""[p](/.?/)[m]?function(t,e){var n=String(this);if(void 0===t&&0===e)return[];if(!l(t))return a.call(n,t,e);var s,i,r,u=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),f=0,p=void 0===e?g:e>>>0,I=new RegExp(t.source,c+"g");while(s=o.call(I,n)){if(i=I[h],i>f&&(u.push(n.slice(f,s.index)),s[m]>1&&s.index<n[m]&&d.apply(u,s.slice(1)),r=s[0][m],f=i,u[m]>=p))break;I[h]===s.index&&I[h]++}return f===n[m]?!r&&I.test("")||u.push(""):u.push(n.slice(f)),u[m]>p?u.slice(0,p):u}:"0"[p](void 0,0)[m]?function(t,e){return void 0===t&&0===e?[]:a.call(this,t,e)}:a,[function(a,l){var n=t(this),s=void 0==a?void 0:a[e];return void 0!==s?s.call(a,n,l):v.call(String(n),a,l)},function(t,e){var l=c(v,t,this,e,v!==a);if(l.done)return l.value;var o=n(t),d=String(this),p=s(o,RegExp),m=o.unicode,h=(o.ignoreCase?"i":"")+(o.multiline?"m":"")+(o.unicode?"u":"")+(I?"y":"g"),k=new p(I?o:"^(?:"+o.source+")",h),b=void 0===e?g:e>>>0;if(0===b)return[];if(0===d.length)return null===u(k,d)?[d]:[];var y=0,S=0,x=[];while(S<d.length){k.lastIndex=I?S:0;var L,_=u(k,I?d:d.slice(S));if(null===_||(L=f(r(k.lastIndex+(I?0:S)),d.length))===y)S=i(d,S,m);else{if(x.push(d.slice(y,S)),x.length===b)return x;for(var w=1;w<=_.length-1;w++)if(x.push(_[w]),x.length===b)return x;S=y=L}}return x.push(d.slice(y)),x}]}))},"469f":function(t,e,a){a("6c1c"),a("1654"),t.exports=a("7d7b")},"5d73":function(t,e,a){t.exports=a("469f")},"5df3":function(t,e,a){"use strict";var l=a("02f4")(!0);a("01f9")(String,"String",(function(t){this._t=String(t),this._i=0}),(function(){var t,e=this._t,a=this._i;return a>=e.length?{value:void 0,done:!0}:(t=l(e,a),this._i+=t.length,{value:t,done:!1})}))},"768b":function(t,e,a){"use strict";var l=a("a745"),n=a.n(l);function s(t){if(n()(t))return t}var i=a("5d73"),r=a.n(i),u=a("c8bb"),o=a.n(u);function c(t,e){if(o()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t)){var a=[],l=!0,n=!1,s=void 0;try{for(var i,u=r()(t);!(l=(i=u.next()).done);l=!0)if(a.push(i.value),e&&a.length===e)break}catch(c){n=!0,s=c}finally{try{l||null==u["return"]||u["return"]()}finally{if(n)throw s}}return a}}function f(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function d(t,e){return s(t)||c(t,e)||f()}a.d(e,"a",(function(){return d}))},"7d7b":function(t,e,a){var l=a("e4ae"),n=a("7cd6");t.exports=a("584a").getIterator=function(t){var e=n(t);if("function"!=typeof e)throw TypeError(t+" is not iterable!");return l(e.call(t))}},aae3:function(t,e,a){var l=a("d3f4"),n=a("2d95"),s=a("2b4c")("match");t.exports=function(t){var e;return l(t)&&(void 0!==(e=t[s])?!!e:"RegExp"==n(t))}},d183:function(t,e,a){"use strict";a.r(e);var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"SPU 名称"}},[a("span",[t._v(t._s(t.spu.spuName))])]),t._v(" "),a("el-form-item",{attrs:{label:"SKU 名称"}},[a("el-input",{attrs:{type:"text",placeholder:"SKU 名称"},model:{value:t.skuInfo.skuName,callback:function(e){t.$set(t.skuInfo,"skuName",e)},expression:"skuInfo.skuName"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"价格(元)"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 价格"},model:{value:t.skuInfo.price,callback:function(e){t.$set(t.skuInfo,"price",e)},expression:"skuInfo.price"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"重量(千克)"}},[a("el-input",{attrs:{type:"number",placeholder:"SKU 重量"},model:{value:t.skuInfo.weight,callback:function(e){t.$set(t.skuInfo,"weight",e)},expression:"skuInfo.weight"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"规格描述"}},[a("el-input",{attrs:{type:"textarea",placeholder:"SKU 规格描述",rows:"4"},model:{value:t.skuInfo.skuDesc,callback:function(e){t.$set(t.skuInfo,"skuDesc",e)},expression:"skuInfo.skuDesc"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"平台属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.attrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px 0"},attrs:{label:e.attrName}},[a("el-select",{attrs:{placeholder:"请输入"},model:{value:e.attrIdValueId,callback:function(a){t.$set(e,"attrIdValueId",a)},expression:"attr.attrIdValueId"}},t._l(e.attrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.valueName,value:e.id+":"+t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"销售属性"}},[a("el-form",{attrs:{inline:"","label-width":"100px"}},t._l(t.spuSaleAttrList,(function(e){return a("el-form-item",{key:e.id,staticStyle:{margin:"5px 0"},attrs:{label:e.saleAttrName}},[a("el-select",{attrs:{placeholder:"请输入"},model:{value:e.saleAttrValueId,callback:function(a){t.$set(e,"saleAttrValueId",a)},expression:"attr.saleAttrValueId"}},t._l(e.spuSaleAttrValueList,(function(t){return a("el-option",{key:t.id,attrs:{label:t.saleAttrValueName,value:t.id}})})),1)],1)})),1)],1),t._v(" "),a("el-form-item",{attrs:{label:"图片列表"}},[a("el-table",{attrs:{border:"",data:t.spuImageList},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{label:"图片"},scopedSlots:t._u([{key:"default",fn:function(t){var e=t.row;return[a("img",{staticStyle:{width:"100px",height:"100px"},attrs:{src:e.imgUrl,alt:""}})]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"名称",prop:"imgName"}}),t._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var l=e.row;e.$index;return["1"===l.isDefault?a("el-tag",{attrs:{type:"success"}},[t._v("默认")]):a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){return t.setDefault(l)}}},[t._v("设为默认")])]}}])})],1)],1),t._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:t.save}},[t._v("保存")]),t._v(" "),a("el-button",{on:{click:t.back}},[t._v("取消")])],1)],1)},n=[],s=(a("5df3"),a("28a5"),a("768b")),i=(a("ac6a"),a("96cf"),a("3b8d")),r={name:"SkuForm",props:{cancel:Function},data:function(){return{spu:{},skuInfo:{category3Id:null,spuId:null,tmId:null,skuName:null,skuDesc:null,price:null,weight:null,skuDefaultImg:null,skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},attrList:[],spuSaleAttrList:[],spuImageList:[],selectedSpuImageList:[]}},methods:{resetData:function(){this.spu={},this.skuInfo={category3Id:null,spuId:null,tmId:null,skuName:null,skuDesc:null,price:null,weight:null,skuDefaultImg:null,skuAttrValueList:[],skuSaleAttrValueList:[],skuImageList:[]},this.attrList=[],this.spuSaleAttrList=[],this.spuImageList=[],this.selectedSpuImageList=[]},back:function(){this.resetData(),this.cancel()},save:function(){var t=Object(i["a"])(regeneratorRuntime.mark((function t(){var e,a,l,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=this.skuInfo,a=this.attrList,l=this.spuSaleAttrList,n=this.selectedSpuImageList,a.forEach((function(t){if(t.attrIdValueId){var a=t.attrIdValueId.split(":"),l=Object(s["a"])(a,2),n=l[0],i=l[1];e.skuAttrValueList.push({attrId:n,valueId:i})}})),e.skuSaleAttrValueList=l.reduce((function(t,e){return e.saleAttrValueId&&t.push({saleAttrValueId:e.saleAttrValueId}),t}),[]),e.skuImageList=n.map((function(t){return{imgName:t.imgName,imgUrl:t.imgUrl,spuImgId:t.id,isDefault:t.isDefault}})),t.next=6,this.$API.sku.addUpdate(e);case 6:this.$message.success("保存SKU成功"),this.resetData(),this.$emit("success");case 9:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),handleSelectionChange:function(t){console.log("handleSelectionChange()",t),this.selectedSpuImageList=t},setDefault:function(t){this.spuImageList.forEach((function(t){return t.isDefault="0"})),t.isDefault="1",this.skuInfo.skuDefaultImg=t.imgUrl},initLoadAddData:function(t){this.spu=t,this.skuInfo.category3Id=t.category3Id,this.skuInfo.spuId=t.id,this.skuInfo.tmId=t.tmId,this.getAddData()},getAddData:function(){var t=this,e=this.spu,a=e.category1Id,l=e.category2Id,n=e.category3Id,s=e.id,i=this.$API.attr.getList(a,l,n),r=this.$API.sku.getSpuSaleAttrList(s),u=this.$API.sku.getSpuImageList(s);Promise.all([i,r,u]).then((function(e){var a=e[0].data,l=e[1].data,n=e[2].data.map((function(t){return t.isDefault="0",t}));t.attrList=a,t.spuSaleAttrList=l,t.spuImageList=n}))}}},u=r,o=a("2877"),c=Object(o["a"])(u,l,n,!1,null,null,null);e["default"]=c.exports}}]);