(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d224d40"],{e296:function(e,i,s){"use strict";s.r(i);var t=function(){var e=this,i=e.$createElement,s=e._self._c||i;return s("div",[s("el-table",{staticStyle:{"margin-bottom":"20px"},attrs:{border:"",data:e.menuPermissionList,"expand-row-keys":e.expandKeys,"row-key":"id"}},[s("el-table-column",{attrs:{prop:"name",label:"名称"}}),e._v(" "),s("el-table-column",{attrs:{prop:"path",label:"访问路径"}}),e._v(" "),s("el-table-column",{attrs:{prop:"component",label:"组件路径"}}),e._v(" "),s("el-table-column",{attrs:{prop:"permissionValue",label:"权限值"}}),e._v(" "),s("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(i){var t=i.row;return[e.$hasBP("permission.add")?s("HintButton",{attrs:{disabled:4===t.level,type:"primary",icon:"el-icon-plus",size:"mini",title:e.getAddTitle(t.level)},on:{click:function(i){return e.toAddPermission(t)}}}):e._e(),e._v(" "),e.$hasBP("permission.update")?s("HintButton",{attrs:{type:"primary",icon:"el-icon-edit",size:"mini",title:4===t.level?"修改功能":"修改菜单"},on:{click:function(i){return e.toUpdatePermission(t)}}}):e._e(),e._v(" "),e.$hasBP("permission.remove")?s("HintButton",{attrs:{disabled:1===t.level,type:"danger",icon:"el-icon-delete",size:"mini",title:"删除"},on:{click:function(i){return e.removePermission(t)}}}):e._e()]}}])})],1),e._v(" "),s("el-dialog",{attrs:{visible:e.dialogPermissionVisible,title:e.dialogTitle},on:{"update:visible":function(i){e.dialogPermissionVisible=i}}},[s("el-form",{ref:"permission",attrs:{model:e.permission,rules:e.permissionRules,"label-width":"120px"}},[s("el-form-item",{attrs:{label:"名称",prop:"name"}},[s("el-input",{model:{value:e.permission.name,callback:function(i){e.$set(e.permission,"name",i)},expression:"permission.name"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"访问路径",prop:"path"}},[s("el-input",{model:{value:e.permission.path,callback:function(i){e.$set(e.permission,"path",i)},expression:"permission.path"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"组件路径",prop:"component"}},[s("el-input",{model:{value:e.permission.component,callback:function(i){e.$set(e.permission,"component",i)},expression:"permission.component"}})],1),e._v(" "),4===e.permission.level?s("el-form-item",{attrs:{label:"功能权限值",prop:"permissionValue"}},[s("el-input",{model:{value:e.permission.permissionValue,callback:function(i){e.$set(e.permission,"permissionValue",i)},expression:"permission.permissionValue"}})],1):e._e(),e._v(" "),2===e.permission.level?s("el-form-item",{attrs:{label:"组件图标",prop:"icon"}},[s("el-select",{attrs:{placeholder:"请选择"},model:{value:e.permission.icon,callback:function(i){e.$set(e.permission,"icon",i)},expression:"permission.icon"}},e._l(e.svgNames,(function(i){return s("el-option",{key:i,attrs:{label:i,value:i}},[s("svg-icon",{staticStyle:{float:"left"},attrs:{"icon-class":i}}),e._v(" "),s("span",{staticStyle:{float:"right"}},[e._v(e._s(i))])],1)})),1)],1):e._e()],1),e._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:e.resetData}},[e._v("取 消")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:e.addOrUpdatePermission}},[e._v("确 定")])],1)],1)],1)},n=[],r=(s("96cf"),s("3b8d")),o=s("db72"),a=s("985d"),l={name:[{required:!0,message:"名称必须输入"}],path:[{required:!0,message:"路径必须输入"}],component:[{required:!0,message:"组件名称必须输入"}]},m={name:[{required:!0,message:"名称必须输入"}],permissionValue:[{required:!0,trigger:"blur",message:"功能权限值必须输入"}]},p={name:"PermissionList",data:function(){return this.svgNames=a["a"],{menuPermissionList:[],expandKeys:[],dialogPermissionVisible:!1,permission:{level:0}}},computed:{dialogTitle:function(){var e=this.permission,i=e.id,s=e.level;return i?4===s?"修改功能":"修改菜单":4===s?"添加功能":"添加菜单"},permissionRules:function(){return 4===this.permission.level?m:l}},mounted:function(){this.fetchPermissionList()},methods:{getAddTitle:function(e){return 1===e||2===e?"添加菜单":3===e?"添加功能":void 0},fetchPermissionList:function(){var e=this;this.$API.permission.getPermissionList().then((function(i){e.menuPermissionList=i.data.children,e.expandKeys=[e.menuPermissionList[0].id]}))},toAddPermission:function(e){var i=this;this.dialogPermissionVisible=!0,this.permission.pid=e.id,this.permission.level=e.level+1,this.$nextTick((function(){return i.$refs.permission.clearValidate()}))},toUpdatePermission:function(e){var i=this;this.dialogPermissionVisible=!0,this.permission=Object(o["a"])({},e),this.$nextTick((function(){return i.$refs.permission.clearValidate()}))},removePermission:function(e){var i=this;this.$confirm("此操作将永久删除该记录, 是否继续?","提示",{type:"warning"}).then(Object(r["a"])(regeneratorRuntime.mark((function s(){var t;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,i.$API.permission.removePermission(e.id);case 2:t=s.sent,i.$message.success(t.message||"删除成功!"),i.fetchPermissionList();case 5:case"end":return s.stop()}}),s)})))).catch((function(e){i.$message({type:"info",message:"已取消删除"})}))},addOrUpdatePermission:function(){var e=this;this.$refs.permission.validate(function(){var i=Object(r["a"])(regeneratorRuntime.mark((function i(s){var t,n,r;return regeneratorRuntime.wrap((function(i){while(1)switch(i.prev=i.next){case 0:if(!s){i.next=9;break}return t=e.permission,n=t.id,i.next=5,e.$API.permission[n?"updatePermission":"addPermission"](t);case 5:r=i.sent,e.$message.success(r.message||"".concat(n?"修改":"添加","成功!")),e.resetData(),e.fetchPermissionList();case 9:case"end":return i.stop()}}),i)})));return function(e){return i.apply(this,arguments)}}())},resetData:function(){this.dialogPermissionVisible=!1,this.permission={level:0}}}},c=p,u=s("2877"),d=Object(u["a"])(c,t,n,!1,null,null,null);i["default"]=d.exports}}]);